{
	$(document).ready(function () {
		console.log("Inventory Category!");
	});

        var catdeletionactionId = "";
        function randomCategoryGUID()
        {
            return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>
            (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
        );
        }

        //var AS = document.getElementById("AutoGeneratedID");
        catdeletionactionId = randomCategoryGUID();

        $(document).ready(function(){

            document.getElementById('backtoInventory').style.visibility = 'hidden';

        var categoriesValues = new Array(0);

        console.log("running fetch..");
        $.get('http://localhost:46568/api/InventoryCategories').done(function (items)
        {
            var json = JSON.stringify(items);
        categoriesValues = items;
        console.log(categoriesValues[0].inventoryCategory_Id);

        $.each(items, function (i, item) {
                var item =
        `<tr>
            <td class="dropdown-primary dropdown open">
                <button class="btn btn-primary dropdown-toggle waves-effect waves-light btn-sm" type="button" id="dropdown-2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Modify</button>
                <div class="dropdown-menu" aria-labelledby="dropdown-2" data-dropdown-in="fadeIn" data-dropdown-out="fadeOut">
                    <a class="dropdown-item waves-light waves-effect" id="${item.inventoryCategory_Id}" onclick=DetailsById(this.id)>Details</a>
                <a class="dropdown-item waves-light waves-effect" id="${item.inventoryCategory_Id}" onclick=EditByInventoryItem(this.id)>Edit</a>
            <a class="dropdown-item waves-light waves-effect" id="${item.inventoryCategory_Id}" onclick=DeleteCategoryById(this.id)>Delete</a>
        <div class="dropdown-divider"></div>
        <a class="dropdown-item waves-light waves-effect" href="/InventoriesUI/InventoryCategory">Add New Category</a>
                            </div>
                        </td >
                        <td>${item.inventoryCategory_Id}</td>
                        <td>${item.inventoryCategory_Name}</td>
                        
                      <tr>`;
                $('#itemlist').append(item);

                   
            });
        });
        
            
    });


     function DetailsById(Id) {
        document.getElementById('backtoInventory').style.visibility = 'visible';
        //get id
        console.log(Id);
        $.get('http://localhost:46568/api/InventoryCategories/'+Id).done(function (items) 
        {
                $('#AllSystemStock').empty();
                  $('#AllSystemStock').append(items.inventoryCategory_Id);
                var itemDetails = 
                        '<div class="col-md-12 col-xl-9 "><div class="card app-design"><div class="card-block"><h6 class="f-w-400 text-muted">Category Id:</h6><h6 class="text-primary f-w-400">'+ items.inventoryCategory_Id +'</h6><br><h6 class="text-muted">Inventory Category Description:</h6><h6 class="text-primary f-w-400">'+ items.inventoryCategory_Name +'</h6><br><div class="design-description d-inline-block m-r-40">'
                                        
                                    '</div>'
                                    '<div class="design-description d-inline-block">'
                                        '<h3 class="f-w-400">1,452</h3>'
                                        '<p class="text-muted">Comments</p>'
                                    '</div>'
                                    '<div class="team-box p-b-20">'
                                        '<p class="d-inline-block m-r-20 f-w-400">Team</p>'
                                        '<div class="team-section d-inline-block">'
                                            '<a href="#! "><img src="libraries\assets\images\avatar-2.jpg" data-toggle="tooltip" title="Josephin Doe" alt=" "></a>'
                                            '<a href="#! "><img src="libraries\assets\images\avatar-3.jpg" data-toggle="tooltip" title="Lary Doe" alt=" " class="m-l-5 "></a>'
                                            '<a href="#! "><img src="libraries\assets\images\avatar-4.jpg" data-toggle="tooltip" title="Alia" alt=" " class="m-l-5 "></a>'
                                            '<a href="#! "><img src="libraries\assets\images\avatar-2.jpg" data-toggle="tooltip" title="Suzen" alt=" " class="m-l-5 "></a>'
                                        '</div>'
                                    '</div>'
                                    '<div class="progress-box">'
                                        '<p class="d-inline-block m-r-20 f-w-400">Progress</p>'
                                        '<div class="progress d-inline-block">'
                                            '<div class="progress-bar bg-c-blue" style="width:78% "><label>78%</label></div>'
                                        '</div>'
                                    '</div>'
                                '</div>'
                            '</div>'
                        '</div>'




                $('#btnactiondetails').empty();
               
                $('#btnactiondetails').append(itemDetails);
                 
                 let current = new Date();
                        let cDate = current.getFullYear() + '-' + (current.getMonth() + 1) + '-' + current.getDate();
                        let cTime = current.getHours() + ":" + current.getMinutes() + ":" + current.getSeconds();
                        let dateTime = cDate + ' ' + cTime;
                      randomCategoryGUID();
                        const dataValues = 
                        {
                            "id": catdeletionactionId,
                            "date": dateTime,
                            "activityName": "Viewing Category Details By Id:",
                            "activityDetails": items.inventoryCategory_Id,
                            "actionedBy": "Dummy-User"
                        }
                        LogUserActivity(dataValues);
                         console.log('Viewing Details by id logged done');

        });

     }
      

     //delete 
     function DeleteCategoryById(inventoryCategory_Id) {
        document.getElementById('backtoInventory').style.visibility = 'visible';
        
                
                  alert("Category deletion Initiated ... ")
                $.ajax({
                    type: 'DELETE',
                    url: 'http://localhost:46568/api/InventoryCategories/'+ inventoryCategory_Id,
                    contentType: 'application/x-www-form-urlencoded; charset=UTF-8', // when we use .serialize() this generates the data in query string format. this needs the default contentType (default content type is: contentType: 'application/x-www-form-urlencoded; charset=UTF-8') so it is optional, you can remove it
                    data: inventoryCategory_Id,
                    success: function (result) {
                        
                       
                       
                        alert('Item successfuly Deleted ');
                         let current = new Date();
                        let cDate = current.getFullYear() + '-' + (current.getMonth() + 1) + '-' + current.getDate();
                        let cTime = current.getHours() + ":" + current.getMinutes() + ":" + current.getSeconds();
                        let dateTime = cDate + ' ' + cTime;
                      
                        randomCategoryGUID();
                        const dataValues = 
                        {
                            "id": catdeletionactionId,
                            "date": dateTime,
                            "activityName": "InventoryCategory Deletion:",
                            "activityDetails": inventoryCategory_Id,
                            "actionedBy": "Dummy-User"
                        }
                        LogUserActivity(dataValues);
                        window.location.reload();
                      

                    },
                    error: function () {
                        alert('Failed to Delete the Category');
                        console.log('Failed ');
                    }
                })
            
     }
     

      function LogUserActivity(dataValues) {
          
                        

          $.ajax({
                    type: 'POST',
                    url: 'http://localhost:46568/api/SystemLoggers/',
                    contentType: 'application/x-www-form-urlencoded; charset=UTF-8', // when we use .serialize() this generates the data in query string format. this needs the default contentType (default content type is: contentType: 'application/x-www-form-urlencoded; charset=UTF-8') so it is optional, you can remove it
                    data: dataValues,
                    success: function (result) {
                   
                      console.log ('System Logger Report: Activity Logged ');
                      
                    },
                    error: function () {
                        console.log('System Logger Report:Activity log Failed ');
                    }
                })

      }
    

}
